## Задача 1  
Перед выполнением задания ознакомьтесь с документацией по администрированию MongoDB.  

Пользователь (разработчик) написал в канал поддержки, что у него уже 3 минуты происходит CRUD операция в MongoDB и её нужно прервать.  

Вы как инженер поддержки решили произвести данную операцию:

- напишите список операций, которые вы будете производить для остановки запроса пользователя  
- предложите вариант решения проблемы с долгими (зависающими) запросами в MongoDB  

Ответ:
1. включаем утилиту free monitoring
db.enableFreeMonitoring()
2. находим этот запрос с помощью команды:
db.currenOp({"secs_running":{$gte:180}})
3. выяснить его opid
db.currentOp()
4. прервать с помощью команды
db.killOp(opid)

перестроить индекс

## Задача 2  
Перед выполнением задания познакомьтесь с документацией по Redis latency troobleshooting.  

Вы запустили инстанс Redis для использования совместно с сервисом, который использует механизм TTL. Причем отношение количества записанных key-value значений к количеству истёкших значений есть величина постоянная и увеличивается пропорционально количеству реплик сервиса.  

При масштабировании сервиса до N реплик вы увидели, что:  

- сначала рост отношения записанных значений к истекшим
- Redis блокирует операции записи 
 
Как вы думаете, в чем может быть проблема?

Ответ:

Наверное, проблема с исчерпанием памяти. возможно, включена huge_page.


## Задача 3  
Вы подняли базу данных MySQL для использования в гис-системе. При росте количества записей, в таблицах базы, пользователи начали жаловаться на ошибки вида:  
```
InterfaceError: (InterfaceError) 2013: Lost connection to MySQL server during query u'SELECT..... '
```

- Как вы думаете, почему это начало происходить и как локализовать проблему?  

- Какие пути решения данной проблемы вы можете предложить?

Ответ:

1. Возможно, совпало с сетевыми проблемами
2. Возможно, из-за увеличения нагрузки на сервер

- устранить сетевую неисправность
- можно увеличить параметр net_read_timeout с 30 до 60 секунд или более
- увеличить  connect_timeout
- иногда можно увидеть ошибку  ER_NET_PACKET_TOO_LARGE , тогда надо увеличить значение max_allowed_packet
- добавить ресурсов на машине
- так же можно увеличить max_connections 

### Задача 4  
Вы решили перевести гис-систему из задачи 3 на PostgreSQL, так как прочитали в документации, что эта СУБД работает с большим объемом данных лучше, чем MySQL.  

После запуска пользователи начали жаловаться, что СУБД время от времени становится недоступной. В dmesg вы видите, что:  

postmaster invoked oom-killer

Как вы думаете, что происходит?

Как бы вы решили данную проблему?

Ответ:  
- Причина в недостатке ресурсов оперативной памяти  
- Необходимо увеличить объем оперативной памяти или выставить ограничение в настройках Postgresql на использование ресурсов хоста

